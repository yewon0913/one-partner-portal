<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>ONE PARTNER ì •ë°€ ì§„ë‹¨ ì„œë¥˜ ì œì¶œ</title>
  <link rel="icon" href="logo.png" type="image/png">
  <link href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/variable/pretendardvariable-dynamic-subset.min.css" rel="stylesheet">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: 'Pretendard Variable', 'Pretendard', -apple-system, BlinkMacSystemFont, sans-serif;
      background-color: #0A1628;
      color: #FFFFFF;
      min-height: 100vh;
    }

    .container {
      max-width: 480px;
      margin: 0 auto;
      min-height: 100vh;
      padding: 0 20px 40px;
      position: relative;
      z-index: 1;
    }

    .watermark {
      position: fixed;
      top: 50%; left: 50%;
      transform: translate(-50%, -50%);
      width: 300px; height: 300px;
      opacity: 0.03;
      pointer-events: none;
      z-index: 0;
    }

    /* Header */
    .header {
      text-align: center;
      padding: 24px 0 8px;
    }

    .logo { width: 80px; height: 80px; border-radius: 16px; }

    .header-title {
      font-size: 20px;
      font-weight: 800;
      color: #C9A84C;
      margin-top: 12px;
    }

    .header-subtitle {
      font-size: 14px;
      color: #8A9BB5;
      margin-top: 6px;
      line-height: 1.5;
    }

    /* Progress */
    .progress-wrap { margin: 16px 0 20px; }
    .progress-track {
      height: 6px;
      background: #1E3A5F;
      border-radius: 3px;
      overflow: hidden;
    }
    .progress-fill {
      height: 100%;
      border-radius: 3px;
      background: linear-gradient(90deg, #C9A84C, #E8D48B);
      transition: width 0.4s ease;
      width: 0%;
    }
    .progress-label {
      color: #8A9BB5;
      font-size: 13px;
      text-align: right;
      margin-top: 6px;
    }

    /* Steps */
    .step { display: none; animation: fadeIn 0.35s ease; }
    .step.active { display: block; }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(16px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* Navigation */
    .back-btn {
      background: none; border: none;
      color: #C9A84C; font-size: 15px; font-weight: 600;
      cursor: pointer; padding: 6px 2px; margin-bottom: 8px;
      display: none; font-family: inherit;
    }
    .back-btn.visible { display: block; }

    /* Section Title */
    .section-num {
      display: inline-flex; align-items: center; justify-content: center;
      width: 32px; height: 32px; border-radius: 50%;
      background: linear-gradient(135deg, #A8893D, #C9A84C);
      color: #0A1628; font-size: 15px; font-weight: 800;
      margin-bottom: 12px;
    }

    .section-title {
      font-size: 22px; font-weight: 800;
      line-height: 1.45; margin-bottom: 8px;
    }

    .section-desc {
      font-size: 14px; color: #8A9BB5;
      line-height: 1.5; margin-bottom: 24px;
    }

    /* Form Elements */
    .field-label {
      color: #8A9BB5; font-size: 14px; font-weight: 600;
      margin-bottom: 8px; margin-top: 18px;
    }

    .field-label:first-of-type { margin-top: 0; }

    .text-input, .number-input {
      width: 100%; background: #0D1E38;
      border-radius: 12px; padding: 16px 18px;
      border: 1.5px solid #1E3A5F;
      color: #FFFFFF; font-size: 16px; font-weight: 500;
      font-family: inherit; outline: none;
      transition: border-color 0.2s ease;
    }

    .text-input:focus, .number-input:focus { border-color: #C9A84C; }
    .text-input::placeholder, .number-input::placeholder { color: #5A6B80; }

    .input-hint {
      font-size: 12px; color: #6B7D94;
      margin-top: 6px; line-height: 1.4;
    }

    /* File Upload */
    .upload-area {
      border: 2px dashed #1E3A5F;
      border-radius: 14px;
      padding: 32px 20px;
      text-align: center;
      cursor: pointer;
      transition: all 0.2s ease;
      background: #0D1E38;
    }

    .upload-area:hover { border-color: #C9A84C; background: rgba(201,168,76,0.04); }

    .upload-area.has-file {
      border-color: #C9A84C;
      background: rgba(201,168,76,0.06);
    }

    .upload-icon {
      font-size: 36px; margin-bottom: 10px;
      color: #C9A84C;
    }

    .upload-text {
      font-size: 15px; font-weight: 600; color: #FFFFFF;
    }

    .upload-sub {
      font-size: 13px; color: #6B7D94; margin-top: 6px;
    }

    .upload-filename {
      font-size: 14px; color: #C9A84C; font-weight: 600;
      margin-top: 8px; word-break: break-all;
    }

    .file-input { display: none; }

    /* Preview Image */
    .preview-img {
      max-width: 100%; max-height: 200px;
      border-radius: 10px; margin-top: 12px;
      border: 1px solid #1E3A5F;
    }

    /* Toggle Buttons (Yes/No) */
    .toggle-group {
      display: flex; gap: 12px;
    }

    .toggle-btn {
      flex: 1; padding: 16px;
      border-radius: 12px;
      border: 1.5px solid #1E3A5F;
      background: #132240;
      color: #FFFFFF;
      font-size: 17px; font-weight: 700;
      cursor: pointer; text-align: center;
      transition: all 0.2s ease;
      font-family: inherit;
    }

    .toggle-btn:hover { border-color: #C9A84C; }
    .toggle-btn:active { transform: scale(0.97); }

    .toggle-btn.selected {
      border-color: #C9A84C;
      background: rgba(201,168,76,0.12);
      color: #C9A84C;
    }

    .toggle-btn.selected-yes {
      border-color: #EF4444;
      background: rgba(239,68,68,0.1);
      color: #F87171;
    }

    .toggle-btn.selected-no {
      border-color: #22C55E;
      background: rgba(34,197,94,0.1);
      color: #4ADE80;
    }

    /* Checkbox */
    .checkbox-group { display: flex; flex-direction: column; gap: 12px; }

    .checkbox-item {
      display: flex; align-items: center; gap: 12px;
      background: #132240; border-radius: 12px;
      padding: 16px 18px; border: 1.5px solid #1E3A5F;
      cursor: pointer; transition: all 0.2s ease;
    }

    .checkbox-item:hover { border-color: #C9A84C; }

    .checkbox-item.checked {
      border-color: #C9A84C;
      background: rgba(201,168,76,0.08);
    }

    .custom-check {
      width: 24px; height: 24px; border-radius: 6px;
      border: 2px solid #1E3A5F; flex-shrink: 0;
      display: flex; align-items: center; justify-content: center;
      transition: all 0.2s ease;
    }

    .checkbox-item.checked .custom-check {
      background: #C9A84C; border-color: #C9A84C;
    }

    .check-icon { color: #0A1628; font-size: 14px; font-weight: 800; display: none; }
    .checkbox-item.checked .check-icon { display: block; }

    .checkbox-label { font-size: 16px; font-weight: 600; }

    /* External Links */
    .ext-links {
      display: flex; gap: 10px; margin-top: 12px;
    }

    .ext-link {
      flex: 1; padding: 12px;
      border-radius: 10px;
      border: 1px solid #1E3A5F;
      background: #132240;
      color: #C9A84C;
      font-size: 14px; font-weight: 600;
      text-decoration: none;
      text-align: center;
      transition: opacity 0.2s ease;
    }

    .ext-link:hover { opacity: 0.8; }

    /* Date Input */
    .date-input {
      width: 100%; background: #0D1E38;
      border-radius: 12px; padding: 16px 18px;
      border: 1.5px solid #1E3A5F;
      color: #FFFFFF; font-size: 16px;
      font-family: inherit; outline: none;
      transition: border-color 0.2s ease;
      -webkit-appearance: none;
    }

    .date-input:focus { border-color: #C9A84C; }
    .date-input::-webkit-calendar-picker-indicator { filter: invert(0.7); }

    /* Revenue Row */
    .revenue-row {
      display: flex; align-items: center; gap: 12px;
      margin-bottom: 12px;
    }

    .revenue-year {
      font-size: 15px; font-weight: 700;
      color: #C9A84C; min-width: 60px;
    }

    .revenue-input {
      flex: 1; background: #0D1E38;
      border-radius: 12px; padding: 14px 16px;
      border: 1.5px solid #1E3A5F;
      color: #FFFFFF; font-size: 16px;
      font-family: inherit; outline: none;
      transition: border-color 0.2s ease;
      text-align: right;
    }

    .revenue-input:focus { border-color: #C9A84C; }
    .revenue-input::placeholder { color: #5A6B80; }

    .revenue-unit {
      font-size: 15px; font-weight: 600;
      color: #8A9BB5; min-width: 30px;
    }

    /* Loan Entry Cards */
    .loan-entries { display: flex; flex-direction: column; gap: 16px; }

    .loan-entry {
      background: #0D1E38; border-radius: 14px;
      padding: 18px; border: 1.5px solid #1E3A5F;
      position: relative;
    }

    .loan-entry-header {
      display: flex; justify-content: space-between;
      align-items: center; margin-bottom: 14px;
    }

    .loan-entry-num {
      font-size: 14px; font-weight: 700; color: #C9A84C;
    }

    .loan-remove-btn {
      background: none; border: 1px solid rgba(239,68,68,0.3);
      color: #F87171; font-size: 13px; font-weight: 600;
      padding: 4px 12px; border-radius: 8px;
      cursor: pointer; font-family: inherit;
    }

    .loan-remove-btn:hover { background: rgba(239,68,68,0.1); }

    .loan-field { margin-bottom: 12px; }
    .loan-field:last-child { margin-bottom: 0; }

    .loan-field-label {
      font-size: 13px; color: #8A9BB5; font-weight: 600;
      margin-bottom: 6px;
    }

    .loan-field-input {
      width: 100%; background: #132240;
      border-radius: 10px; padding: 13px 14px;
      border: 1px solid #1E3A5F;
      color: #FFFFFF; font-size: 15px;
      font-family: inherit; outline: none;
      transition: border-color 0.2s ease;
    }

    .loan-field-input:focus { border-color: #C9A84C; }
    .loan-field-input::placeholder { color: #5A6B80; }

    .add-loan-btn {
      width: 100%; padding: 14px;
      border-radius: 12px;
      border: 2px dashed #1E3A5F;
      background: transparent;
      color: #C9A84C; font-size: 15px; font-weight: 700;
      cursor: pointer; font-family: inherit;
      margin-top: 12px;
      transition: all 0.2s ease;
    }

    .add-loan-btn:hover { border-color: #C9A84C; background: rgba(201,168,76,0.04); }

    /* Button Group */
    .btn-group {
      display: flex; gap: 12px; margin-top: 28px;
    }

    .prev-btn {
      flex: 0 0 auto; width: 80px;
      padding: 18px 0; border-radius: 14px;
      border: 1.5px solid #1E3A5F;
      background: #132240;
      color: #C9A84C; font-size: 16px; font-weight: 700;
      cursor: pointer; font-family: inherit;
      transition: all 0.15s ease;
    }

    .prev-btn:hover { border-color: #C9A84C; }
    .prev-btn:active { transform: scale(0.97); }

    /* Buttons */
    .next-btn, .submit-btn {
      display: block; width: 100%; flex: 1;
      padding: 18px; border: none; border-radius: 14px;
      background: linear-gradient(135deg, #A8893D, #C9A84C, #E8D48B);
      color: #0A1628; font-size: 18px; font-weight: 800;
      cursor: pointer;
      transition: transform 0.15s ease;
      font-family: inherit;
    }

    .next-btn:active, .submit-btn:active { transform: scale(0.97); }
    .submit-btn:disabled { opacity: 0.6; cursor: not-allowed; }

    /* Security Footer */
    .security-footer {
      text-align: center; margin-top: 24px;
      padding: 16px; border-radius: 12px;
      background: rgba(30,58,95,0.3);
      border: 1px solid #1E3A5F;
    }

    .security-icon { font-size: 20px; margin-bottom: 6px; }

    .security-text {
      font-size: 12px; color: #8A9BB5;
      line-height: 1.5;
    }

    /* Completion */
    .completion { text-align: center; animation: fadeIn 0.4s ease; }

    .check-circle {
      width: 80px; height: 80px; border-radius: 50%;
      background: rgba(201,168,76,0.15);
      display: flex; align-items: center; justify-content: center;
      margin: 20px auto 24px;
      border: 2px solid #C9A84C;
    }

    .check-mark { color: #C9A84C; font-size: 36px; font-weight: 700; }

    .completion-title {
      font-size: 24px; font-weight: 800; margin-bottom: 12px;
    }

    .completion-sub {
      font-size: 15px; color: #8A9BB5;
      line-height: 1.5; margin-bottom: 28px;
    }

    .summary-card {
      background: #132240; border-radius: 16px;
      padding: 24px; border: 1px solid #1E3A5F;
      margin-bottom: 24px; text-align: left;
    }

    .summary-title {
      font-size: 17px; font-weight: 700;
      color: #C9A84C; margin-bottom: 16px;
    }

    .summary-row {
      display: flex; justify-content: space-between;
      padding: 10px 0; border-bottom: 0.5px solid #1E3A5F;
      align-items: flex-start;
    }

    .summary-row:last-child { border-bottom: none; }

    .summary-label { color: #8A9BB5; font-size: 14px; min-width: 90px; }
    .summary-value {
      color: #FFFFFF; font-size: 14px; font-weight: 600;
      text-align: right; flex: 1;
    }

    .reset-btn {
      padding: 14px 32px; border-radius: 12px;
      border: 1.5px solid #C9A84C;
      background: transparent; color: #C9A84C;
      font-size: 16px; font-weight: 600;
      cursor: pointer; font-family: inherit;
    }

    .reset-btn:hover { opacity: 0.8; }

    /* Responsive */
    @media (max-width: 360px) {
      .section-title { font-size: 20px; }
      .revenue-year { font-size: 14px; min-width: 52px; }
    }
  </style>
</head>
<body>
  <img src="logo.png" class="watermark" alt="">

  <div class="container">
    <!-- Header -->
    <div class="header">
      <img src="logo.png" alt="ONE PARTNER" class="logo">
      <div class="header-title">ì •ë°€ ì§„ë‹¨ ì„œë¥˜ ì œì¶œ</div>
      <div class="header-subtitle">ì •ì±…ìê¸ˆ ìŠ¹ì¸ ê°€ëŠ¥ì„± ê²€í† ë¥¼ ìœ„í•œ ìƒì„¸ ì •ë³´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.</div>
    </div>

    <!-- Progress -->
    <div class="progress-wrap">
      <div class="progress-track">
        <div class="progress-fill" id="progressFill"></div>
      </div>
      <div class="progress-label" id="progressLabel">1 / 7 ë‹¨ê³„</div>
    </div>

    <!-- Back -->
    <button class="back-btn" id="backBtn" onclick="goBack()">â† ì´ì „</button>

    <!-- Step 1: ì‚¬ì—…ì ë“±ë¡ì¦ -->
    <div class="step active" id="step1">
      <div class="section-num">1</div>
      <div class="section-title">ì‚¬ì—…ì ë“±ë¡ì¦ ì‚¬ì§„ì„<br>ì—…ë¡œë“œí•´ì£¼ì„¸ìš”.</div>
      <div class="section-desc">ì¹´ë©”ë¼ë¡œ ì´¬ì˜í•˜ê±°ë‚˜ ê°¤ëŸ¬ë¦¬ì—ì„œ ì„ íƒí•´ì£¼ì„¸ìš”.</div>

      <div class="upload-area" id="bizUploadArea" onclick="document.getElementById('bizFile').click()">
        <div class="upload-icon">ğŸ“„</div>
        <div class="upload-text">ì‚¬ì—…ì ë“±ë¡ì¦ ì—…ë¡œë“œ</div>
        <div class="upload-sub">JPG, PNG, PDF (ìµœëŒ€ 10MB)</div>
        <div class="upload-filename" id="bizFileName"></div>
        <img class="preview-img" id="bizPreview" style="display:none" alt="ë¯¸ë¦¬ë³´ê¸°">
      </div>
      <input type="file" class="file-input" id="bizFile" accept="image/*,.pdf" onchange="handleFileUpload(this, 'biz')">

      <button class="next-btn" onclick="validateStep(1)" style="margin-top:28px">ë‹¤ìŒ</button>
    </div>

    <!-- Step 2: ì§ì› ìˆ˜ -->
    <div class="step" id="step2">
      <div class="section-num">2</div>
      <div class="section-title">4ëŒ€ ë³´í—˜ ê°€ì…<br>ì§ì› ìˆ˜ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.</div>
      <div class="section-desc">í˜„ì¬ 4ëŒ€ ë³´í—˜ì— ê°€ì…ëœ ì§ì› ìˆ˜ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.</div>

      <div class="field-label">ì§ì› ìˆ˜</div>
      <input type="number" class="number-input" id="employeeCount" placeholder="ì˜ˆ: 5" min="0" inputmode="numeric">
      <div class="input-hint">ëŒ€í‘œì ë³¸ì¸ í¬í•¨ ì—¬ë¶€ëŠ” ìƒê´€ì—†ìŠµë‹ˆë‹¤.</div>

      <div class="btn-group">
        <button class="prev-btn" onclick="goBack()">â† ì´ì „</button>
        <button class="next-btn" onclick="validateStep(2)">ë‹¤ìŒ</button>
      </div>
    </div>

    <!-- Step 3: ë§¤ì¶œ í˜„í™© -->
    <div class="step" id="step3">
      <div class="section-num">3</div>
      <div class="section-title">ì—°ë„ë³„ ë§¤ì¶œ í˜„í™©ì„<br>ì…ë ¥í•´ì£¼ì„¸ìš”.</div>
      <div class="section-desc">ë¶€ê°€ì„¸ ì‹ ê³ ì•¡ ê¸°ì¤€ìœ¼ë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”.</div>

      <div class="revenue-row">
        <span class="revenue-year">2023ë…„</span>
        <input type="text" class="revenue-input" id="revenue2023" placeholder="0" inputmode="numeric" oninput="formatRevenue(this)">
        <span class="revenue-unit">ë§Œì›</span>
      </div>

      <div class="revenue-row">
        <span class="revenue-year">2024ë…„</span>
        <input type="text" class="revenue-input" id="revenue2024" placeholder="0" inputmode="numeric" oninput="formatRevenue(this)">
        <span class="revenue-unit">ë§Œì›</span>
      </div>

      <div class="revenue-row">
        <span class="revenue-year">2025ë…„</span>
        <input type="text" class="revenue-input" id="revenue2025" placeholder="0" inputmode="numeric" oninput="formatRevenue(this)">
        <span class="revenue-unit">ë§Œì›</span>
      </div>
      <div class="input-hint">2025ë…„ì€ ì˜ˆìƒ ë§¤ì¶œì„ ì…ë ¥í•´ì£¼ì„¸ìš”.</div>

      <div class="btn-group">
        <button class="prev-btn" onclick="goBack()">â† ì´ì „</button>
        <button class="next-btn" onclick="validateStep(3)">ë‹¤ìŒ</button>
      </div>
    </div>

    <!-- Step 4: ì‹ ìš© ì ìˆ˜ -->
    <div class="step" id="step4">
      <div class="section-num">4</div>
      <div class="section-title">ëŒ€í‘œì ì‹ ìš©ë“±ê¸‰ì„<br>ì…ë ¥í•´ì£¼ì„¸ìš”.</div>
      <div class="section-desc">KCB ë˜ëŠ” NICE ê¸°ì¤€ ì‹ ìš©ì ìˆ˜ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.</div>

      <div class="field-label">ì‹ ìš© ì ìˆ˜</div>
      <input type="number" class="number-input" id="creditScore" placeholder="ì˜ˆ: 850" min="0" max="1000" inputmode="numeric">
      <div class="input-hint">ì¹´ì¹´ì˜¤í˜ì´ ë˜ëŠ” í† ìŠ¤ì—ì„œ ê°„í¸ ì¡°íšŒ ê°€ëŠ¥í•©ë‹ˆë‹¤.</div>

      <div class="ext-links">
        <a href="https://credit.kakao.com" target="_blank" class="ext-link">ì¹´ì¹´ì˜¤ì—ì„œ í™•ì¸ â†’</a>
        <a href="https://toss.im" target="_blank" class="ext-link">í† ìŠ¤ì—ì„œ í™•ì¸ â†’</a>
      </div>

      <div class="field-label" style="margin-top:24px">ì‹ ìš©ì ìˆ˜ ìº¡ì²˜ë³¸ (ì„ íƒ)</div>
      <div class="upload-area" id="creditUploadArea" onclick="document.getElementById('creditFile').click()" style="padding:20px">
        <div class="upload-text" style="font-size:14px">ğŸ“ ìº¡ì²˜ë³¸ ì—…ë¡œë“œ (ì„ íƒì‚¬í•­)</div>
        <div class="upload-filename" id="creditFileName"></div>
        <img class="preview-img" id="creditPreview" style="display:none" alt="ë¯¸ë¦¬ë³´ê¸°">
      </div>
      <input type="file" class="file-input" id="creditFile" accept="image/*" onchange="handleFileUpload(this, 'credit')">

      <div class="btn-group">
        <button class="prev-btn" onclick="goBack()">â† ì´ì „</button>
        <button class="next-btn" onclick="validateStep(4)">ë‹¤ìŒ</button>
      </div>
    </div>

    <!-- Step 5: ì—°ì²´ ì—¬ë¶€ -->
    <div class="step" id="step5">
      <div class="section-num">5</div>
      <div class="section-title">ëŒ€ì¶œ ë° ì¹´ë“œ ì—°ì²´<br>ê²½í—˜ì´ ìˆìœ¼ì‹ ê°€ìš”?</div>
      <div class="section-desc">3ì¼ ì´ìƒ ì—°ì²´ ê²½í—˜ ì—¬ë¶€ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.</div>

      <div class="toggle-group">
        <button class="toggle-btn" id="overdueYes" onclick="selectOverdue('yes')">ì˜ˆ, ìˆìŠµë‹ˆë‹¤</button>
        <button class="toggle-btn" id="overdueNo" onclick="selectOverdue('no')">ì•„ë‹ˆì˜¤</button>
      </div>

      <div class="btn-group" style="margin-top:32px">
        <button class="prev-btn" onclick="goBack()">â† ì´ì „</button>
        <button class="next-btn" onclick="validateStep(5)">ë‹¤ìŒ</button>
      </div>
    </div>

    <!-- Step 6: ì •ë¶€ ëŒ€ì¶œ -->
    <div class="step" id="step6">
      <div class="section-num">6</div>
      <div class="section-title">ê¸°ì¡´ ì •ë¶€ ëŒ€ì¶œì´<br>ìˆìœ¼ì‹ ê°€ìš”?</div>
      <div class="section-desc">ì½”ë¡œë‚˜ ëŒ€ì¶œ, íƒ€ ì‚¬ì—…ì ëŒ€ì¶œ í¬í•¨</div>

      <div class="toggle-group" style="margin-bottom:20px">
        <button class="toggle-btn" id="govLoanYes" onclick="selectGovLoan('yes')">ì˜ˆ, ìˆìŠµë‹ˆë‹¤</button>
        <button class="toggle-btn" id="govLoanNo" onclick="selectGovLoan('no')">ì—†ìŠµë‹ˆë‹¤</button>
      </div>

      <div id="govLoanDetail" style="display:none">
        <div class="input-hint" style="margin-bottom:16px">ëŒ€ì¶œ ê±´ë³„ë¡œ ê¸°ê´€ëª…, ì‹¤í–‰ì¼, ê¸ˆì•¡ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.</div>
        <div class="loan-entries" id="loanEntries"></div>
        <button class="add-loan-btn" onclick="addLoanEntry()">+ ëŒ€ì¶œ ê±´ ì¶”ê°€í•˜ê¸°</button>
      </div>

      <div class="btn-group">
        <button class="prev-btn" onclick="goBack()">â† ì´ì „</button>
        <button class="next-btn" onclick="validateStep(6)">ë‹¤ìŒ</button>
      </div>
    </div>

    <!-- Step 7: ê¸°íƒ€ ëŒ€ì¶œ -->
    <div class="step" id="step7">
      <div class="section-num">7</div>
      <div class="section-title">í˜„ì¬ ì‹ ìš©ëŒ€ì¶œ<br>í˜„í™©ì„ ì„ íƒí•´ì£¼ì„¸ìš”.</div>
      <div class="section-desc">í•´ë‹¹í•˜ëŠ” í•­ëª©ì„ ëª¨ë‘ ì„ íƒí•´ì£¼ì„¸ìš”.</div>

      <div class="checkbox-group">
        <div class="checkbox-item" onclick="toggleCheck(this, 'creditLoan')">
          <div class="custom-check"><span class="check-icon">âœ“</span></div>
          <span class="checkbox-label">ì‹ ìš©ëŒ€ì¶œ ìˆìŒ</span>
        </div>
        <div class="checkbox-item" onclick="toggleCheck(this, 'cardLoan')">
          <div class="custom-check"><span class="check-icon">âœ“</span></div>
          <span class="checkbox-label">ì¹´ë“œë¡  ì´ìš© ì¤‘</span>
        </div>
        <div class="checkbox-item" onclick="toggleCheck(this, 'cashService')">
          <div class="custom-check"><span class="check-icon">âœ“</span></div>
          <span class="checkbox-label">í˜„ê¸ˆì„œë¹„ìŠ¤ ì´ìš© ì¤‘</span>
        </div>
        <div class="checkbox-item" onclick="toggleCheck(this, 'noLoan')">
          <div class="custom-check"><span class="check-icon">âœ“</span></div>
          <span class="checkbox-label">í•´ë‹¹ ì—†ìŒ</span>
        </div>
      </div>

      <div class="btn-group" style="margin-top:32px">
        <button class="prev-btn" onclick="goBack()">â† ì´ì „</button>
        <button class="submit-btn" id="submitBtn" onclick="handleSubmit()">ì œì¶œí•˜ê¸°</button>
      </div>

      <div class="security-footer">
        <div class="security-icon">ğŸ”’</div>
        <div class="security-text">
          ê·€í•˜ì˜ ì •ë³´ëŠ” 256ë¹„íŠ¸ ì•”í˜¸í™” ê¸°ìˆ ë¡œ ì•ˆì „í•˜ê²Œ ë³´í˜¸ë˜ë©°<br>
          ìƒë‹´ ì™„ë£Œ í›„ ì¦‰ì‹œ íŒŒê¸°ë©ë‹ˆë‹¤.
        </div>
      </div>
    </div>

    <!-- Step 8: Completion -->
    <div class="step" id="step8">
      <div class="completion">
        <div class="check-circle">
          <span class="check-mark">âœ“</span>
        </div>
        <div class="completion-title">ì„œë¥˜ ì œì¶œ ì™„ë£Œ!</div>
        <div class="completion-sub">
          ì œì¶œí•˜ì‹  ì„œë¥˜ë¥¼ ê²€í†  í›„<br>
          ë¹ ë¥¸ ì‹œì¼ ë‚´ì— ì—°ë½ë“œë¦¬ê² ìŠµë‹ˆë‹¤.
        </div>
        <div class="summary-card" id="summaryCard"></div>
        <button class="reset-btn" onclick="resetForm()">ì²˜ìŒìœ¼ë¡œ ëŒì•„ê°€ê¸°</button>
      </div>
    </div>
  </div>

  <script>
    let currentStep = 1;
    const totalSteps = 7;

    const formData = {
      bizFile: null,
      bizFileName: '',
      employeeCount: '',
      revenue2023: '',
      revenue2024: '',
      revenue2025: '',
      creditScore: '',
      creditFile: null,
      creditFileName: '',
      overdue: '',
      govLoan: '',
      govLoans: [],
      otherLoans: []
    };

    let loanEntryCount = 0;

    function addLoanEntry() {
      loanEntryCount++;
      const container = document.getElementById('loanEntries');
      const entry = document.createElement('div');
      entry.className = 'loan-entry';
      entry.id = 'loanEntry' + loanEntryCount;
      entry.innerHTML = `
        <div class="loan-entry-header">
          <span class="loan-entry-num">ëŒ€ì¶œ ${loanEntryCount}</span>
          ${loanEntryCount > 1 ? `<button class="loan-remove-btn" onclick="removeLoanEntry(${loanEntryCount})">ì‚­ì œ</button>` : ''}
        </div>
        <div class="loan-field">
          <div class="loan-field-label">ëŒ€ì¶œ ê¸°ê´€ëª…</div>
          <input type="text" class="loan-field-input" placeholder="ì˜ˆ: ì¤‘ì†Œê¸°ì—…ì§„í¥ê³µë‹¨, ì†Œìƒê³µì¸ì‹œì¥ì§„í¥ê³µë‹¨" data-loan-id="${loanEntryCount}" data-field="institution">
        </div>
        <div class="loan-field">
          <div class="loan-field-label">ëŒ€ì¶œ ì‹¤í–‰ì¼</div>
          <input type="date" class="loan-field-input" style="-webkit-appearance:none" data-loan-id="${loanEntryCount}" data-field="date">
        </div>
        <div class="loan-field">
          <div class="loan-field-label">ëŒ€ì¶œ ê¸ˆì•¡ (ë§Œì›)</div>
          <input type="text" class="loan-field-input" placeholder="ì˜ˆ: 5,000" inputmode="numeric" oninput="formatRevenue(this)" data-loan-id="${loanEntryCount}" data-field="amount">
        </div>
      `;
      container.appendChild(entry);
      renumberLoanEntries();
    }

    function removeLoanEntry(id) {
      const entry = document.getElementById('loanEntry' + id);
      if (entry) entry.remove();
      renumberLoanEntries();
    }

    function renumberLoanEntries() {
      const entries = document.querySelectorAll('.loan-entry');
      entries.forEach((entry, idx) => {
        const numEl = entry.querySelector('.loan-entry-num');
        if (numEl) numEl.textContent = 'ëŒ€ì¶œ ' + (idx + 1);
      });
    }

    function collectLoanEntries() {
      const entries = document.querySelectorAll('.loan-entry');
      const loans = [];
      entries.forEach(entry => {
        const institution = entry.querySelector('[data-field="institution"]')?.value || '';
        const date = entry.querySelector('[data-field="date"]')?.value || '';
        const amount = entry.querySelector('[data-field="amount"]')?.value || '';
        if (institution || date || amount) {
          loans.push({ institution, date, amount });
        }
      });
      return loans;
    }

    // Navigation
    function goToStep(step) {
      document.querySelectorAll('.step').forEach(s => s.classList.remove('active'));
      document.getElementById('step' + step).classList.add('active');
      currentStep = step;
      updateProgress();
      updateBackBtn();
      window.scrollTo({ top: 0, behavior: 'instant' });
    }

    function goBack() {
      if (currentStep > 1) goToStep(currentStep - 1);
    }

    function updateProgress() {
      const pct = currentStep <= totalSteps ? (currentStep / totalSteps) * 100 : 100;
      document.getElementById('progressFill').style.width = pct + '%';
      document.getElementById('progressLabel').textContent =
        currentStep <= totalSteps ? currentStep + ' / ' + totalSteps + ' ë‹¨ê³„' : 'ì™„ë£Œ';
    }

    function updateBackBtn() {
      const btn = document.getElementById('backBtn');
      btn.classList.toggle('visible', currentStep > 1 && currentStep <= totalSteps);
    }

    // File Upload
    function handleFileUpload(input, type) {
      const file = input.files[0];
      if (!file) return;

      const area = document.getElementById(type + 'UploadArea');
      const nameEl = document.getElementById(type + 'FileName');
      const previewEl = document.getElementById(type + 'Preview');

      area.classList.add('has-file');
      nameEl.textContent = file.name;

      if (type === 'biz') {
        formData.bizFile = file;
        formData.bizFileName = file.name;
      } else {
        formData.creditFile = file;
        formData.creditFileName = file.name;
      }

      if (file.type.startsWith('image/')) {
        const reader = new FileReader();
        reader.onload = (e) => {
          previewEl.src = e.target.result;
          previewEl.style.display = 'block';
        };
        reader.readAsDataURL(file);
      }
    }

    // Revenue formatting
    function formatRevenue(input) {
      let val = input.value.replace(/[^0-9]/g, '');
      if (val) {
        val = Number(val).toLocaleString();
      }
      input.value = val;
    }

    // Overdue
    function selectOverdue(val) {
      formData.overdue = val;
      document.getElementById('overdueYes').className = 'toggle-btn' + (val === 'yes' ? ' selected-yes' : '');
      document.getElementById('overdueNo').className = 'toggle-btn' + (val === 'no' ? ' selected-no' : '');
    }

    // Gov Loan
    function selectGovLoan(val) {
      formData.govLoan = val;
      document.getElementById('govLoanYes').className = 'toggle-btn' + (val === 'yes' ? ' selected' : '');
      document.getElementById('govLoanNo').className = 'toggle-btn' + (val === 'no' ? ' selected' : '');
      const detail = document.getElementById('govLoanDetail');
      detail.style.display = val === 'yes' ? 'block' : 'none';
      if (val === 'yes' && document.querySelectorAll('.loan-entry').length === 0) {
        addLoanEntry();
      }
    }

    // Checkbox
    function toggleCheck(el, value) {
      // "í•´ë‹¹ ì—†ìŒ" logic
      if (value === 'noLoan') {
        const isChecked = el.classList.contains('checked');
        document.querySelectorAll('.checkbox-item').forEach(item => item.classList.remove('checked'));
        formData.otherLoans = [];
        if (!isChecked) {
          el.classList.add('checked');
          formData.otherLoans = ['í•´ë‹¹ ì—†ìŒ'];
        }
        return;
      }

      // Remove "í•´ë‹¹ ì—†ìŒ" if other selected
      const noLoanEl = document.querySelectorAll('.checkbox-item')[3];
      noLoanEl.classList.remove('checked');
      formData.otherLoans = formData.otherLoans.filter(v => v !== 'í•´ë‹¹ ì—†ìŒ');

      el.classList.toggle('checked');
      const labels = { creditLoan: 'ì‹ ìš©ëŒ€ì¶œ', cardLoan: 'ì¹´ë“œë¡ ', cashService: 'í˜„ê¸ˆì„œë¹„ìŠ¤' };
      const label = labels[value];

      if (el.classList.contains('checked')) {
        if (!formData.otherLoans.includes(label)) formData.otherLoans.push(label);
      } else {
        formData.otherLoans = formData.otherLoans.filter(v => v !== label);
      }
    }

    // Validation
    function validateStep(step) {
      switch (step) {
        case 1:
          if (!formData.bizFile) { alert('ì‚¬ì—…ì ë“±ë¡ì¦ì„ ì—…ë¡œë“œí•´ì£¼ì„¸ìš”.'); return; }
          break;
        case 2:
          const emp = document.getElementById('employeeCount').value;
          if (!emp) { alert('ì§ì› ìˆ˜ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.'); return; }
          formData.employeeCount = emp;
          break;
        case 3:
          const r23 = document.getElementById('revenue2023').value;
          const r24 = document.getElementById('revenue2024').value;
          const r25 = document.getElementById('revenue2025').value;
          if (!r23 || !r24 || !r25) { alert('ëª¨ë“  ì—°ë„ì˜ ë§¤ì¶œì„ ì…ë ¥í•´ì£¼ì„¸ìš”.'); return; }
          formData.revenue2023 = r23;
          formData.revenue2024 = r24;
          formData.revenue2025 = r25;
          break;
        case 4:
          const cs = document.getElementById('creditScore').value;
          if (!cs) { alert('ì‹ ìš© ì ìˆ˜ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.'); return; }
          formData.creditScore = cs;
          break;
        case 5:
          if (!formData.overdue) { alert('ì—°ì²´ ì—¬ë¶€ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.'); return; }
          break;
        case 6:
          if (!formData.govLoan) { alert('ì •ë¶€ ëŒ€ì¶œ ìœ ë¬´ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.'); return; }
          if (formData.govLoan === 'yes') {
            formData.govLoans = collectLoanEntries();
            if (formData.govLoans.length === 0) {
              alert('ëŒ€ì¶œ ì •ë³´ë¥¼ í•˜ë‚˜ ì´ìƒ ì…ë ¥í•´ì£¼ì„¸ìš”.'); return;
            }
          }
          break;
      }
      goToStep(step + 1);
    }

    // Submit
    async function handleSubmit() {
      if (formData.otherLoans.length === 0) {
        alert('ì‹ ìš©ëŒ€ì¶œ í˜„í™©ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
        return;
      }

      const btn = document.getElementById('submitBtn');
      btn.disabled = true;
      btn.textContent = 'ì œì¶œ ì¤‘...';

      // Build form data for server
      const fd = new FormData();
      if (formData.bizFile) fd.append('bizFile', formData.bizFile);
      if (formData.creditFile) fd.append('creditFile', formData.creditFile);
      fd.append('data', JSON.stringify({
        employeeCount: formData.employeeCount,
        revenue2023: formData.revenue2023,
        revenue2024: formData.revenue2024,
        revenue2025: formData.revenue2025,
        creditScore: formData.creditScore,
        overdue: formData.overdue === 'yes' ? 'ìˆìŒ' : 'ì—†ìŒ',
        govLoan: formData.govLoan === 'yes' ? 'ìˆìŒ' : 'ì—†ìŒ',
        govLoans: formData.govLoans || [],
        otherLoans: formData.otherLoans.join(', '),
        submittedAt: new Date().toLocaleString('ko-KR')
      }));

      try {
        await fetch('/api/submit', { method: 'POST', body: fd });
      } catch (e) {
        console.log('Submission data:', formData);
      }

      // Save to localStorage for admin dashboard
      const submissions = JSON.parse(localStorage.getItem('op_submissions') || '[]');
      submissions.push({
        id: Date.now(),
        bizFileName: formData.bizFileName,
        employeeCount: formData.employeeCount,
        revenue2023: formData.revenue2023,
        revenue2024: formData.revenue2024,
        revenue2025: formData.revenue2025,
        creditScore: formData.creditScore,
        creditFileName: formData.creditFileName || '-',
        overdue: formData.overdue === 'yes' ? 'ìˆìŒ' : 'ì—†ìŒ',
        govLoan: formData.govLoan === 'yes' ? 'ìˆìŒ' : 'ì—†ìŒ',
        govLoans: formData.govLoans || [],
        otherLoans: formData.otherLoans.join(', '),
        submittedAt: new Date().toLocaleString('ko-KR')
      });
      localStorage.setItem('op_submissions', JSON.stringify(submissions));

      showCompletion();
      btn.disabled = false;
      btn.textContent = 'ì œì¶œí•˜ê¸°';
    }

    function showCompletion() {
      const card = document.getElementById('summaryCard');
      const rows = [
        ['ì‚¬ì—…ìë“±ë¡ì¦', formData.bizFileName],
        ['ì§ì› ìˆ˜', formData.employeeCount + 'ëª…'],
        ['2023 ë§¤ì¶œ', formData.revenue2023 + ' ë§Œì›'],
        ['2024 ë§¤ì¶œ', formData.revenue2024 + ' ë§Œì›'],
        ['2025 ë§¤ì¶œ(ì˜ˆìƒ)', formData.revenue2025 + ' ë§Œì›'],
        ['ì‹ ìš© ì ìˆ˜', formData.creditScore + 'ì '],
        ['ì—°ì²´ ì—¬ë¶€', formData.overdue === 'yes' ? 'ìˆìŒ' : 'ì—†ìŒ'],
        ['ì •ë¶€ ëŒ€ì¶œ', formData.govLoan === 'yes' ? 'ìˆìŒ' : 'ì—†ìŒ'],
        ['ê¸°íƒ€ ëŒ€ì¶œ', formData.otherLoans.join(', ')]
      ];

      if (formData.govLoan === 'yes' && formData.govLoans.length > 0) {
        formData.govLoans.forEach((loan, i) => {
          rows.splice(8 + i, 0, [`ëŒ€ì¶œ${i+1}: ${loan.institution}`, `${loan.date} / ${loan.amount}ë§Œì›`]);
        });
      }

      card.innerHTML = '<div class="summary-title">ì œì¶œ ë‚´ì—­ ìš”ì•½</div>' +
        rows.map(([l, v]) =>
          `<div class="summary-row"><span class="summary-label">${l}</span><span class="summary-value">${v}</span></div>`
        ).join('');

      goToStep(8);
    }

    function resetForm() {
      Object.keys(formData).forEach(k => {
        if (k === 'otherLoans') formData[k] = [];
        else if (k === 'bizFile' || k === 'creditFile') formData[k] = null;
        else formData[k] = '';
      });
      document.querySelectorAll('input').forEach(i => i.value = '');
      document.querySelectorAll('.toggle-btn, .checkbox-item').forEach(e => {
        e.classList.remove('selected', 'selected-yes', 'selected-no', 'checked');
      });
      document.querySelectorAll('.upload-area').forEach(a => a.classList.remove('has-file'));
      document.querySelectorAll('.upload-filename').forEach(n => n.textContent = '');
      document.querySelectorAll('.preview-img').forEach(p => { p.style.display = 'none'; p.src = ''; });
      document.getElementById('govLoanDetail').style.display = 'none';
      document.getElementById('loanEntries').innerHTML = '';
      loanEntryCount = 0;
      goToStep(1);
    }

    // Init
    updateProgress();
  </script>
</body>
</html>
